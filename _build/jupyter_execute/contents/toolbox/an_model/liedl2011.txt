### CAST Toolbox - Analytical Models - Liedl et al. 2011 ####

####  Liedl et al. (2011) model (a **<u>3D</u> Model**) ####

This model, based on {ref}`Liedl et al. (2011)<refli2011>`, provides an estimate of a steady-state plume length ($L_{max}$ ) from a 3D model domain (see figure). This model extends the 2D model present in Liedl et al. (2005). As is in the 2D model, in this model too the vertical orientation refers to $z$-axis being aligned to the aquifer thickness. The domain width and length is infinite in this model.


```{figure} images/an_li2011_f1.png
---
scale: 40%
align: center
name: li2011
---
Liedl et al. (2011)- conceptual set-up
```

Liedl et al.(2011) provides the following implicit expression for $L_{max}$:

```{sidebar} Symbols:
$M$ = Source Thickness [L], which is equal to Aquifer thickness ($A_t$) [L]<br/>
$\alpha_{Tv}$ = Vertical Transverse Dispersivity [L]<br/>
$W$ = Source Width [L]<br/>
$\alpha_{Th}$ = Horizontal Transverse Dispersivity [L]<br/>
$\gamma$ = Reaction stoichiometric ratio [ ]<br/>
$C_{ED}^\circ$ = Contaminant (Electron Donor) concentration [ML$^{-1}$]<br/>
$C_{EA}^\circ$ = Partner Reactant (Electron Acceptor) concentration [ML$^{-1}$]<br/>
$C_{Thres}$ = Threshold Contaminant Concentration [ML$^{-1}$]
``` 

$$
\text{erf}\bigg(\frac{W}{\sqrt{4\alpha_{Th}L}}\bigg)\,\text{e}^{-\alpha_{Tv}L \big(\frac{\pi}{2M}\big)^2} =\frac{\pi}{4}\frac{\gamma C_{Thres}+C_{EA}^\circ}{\gamma C_{ED}^\circ+C_{EA}^\circ}
$$(eqli2011) 



The $C_{Thres}$ in this model allows to set the contaminant concentration to any value greater than or equal to zero, and then $L_{max}$ is length from the origin to that maximum distance of $C_{Thres}$ along $x$-axis . 

##### The model is based on the following assumptions: #####

1. Steady-state condition in a homogeneous and isotropic aquifer.
2. A single step bi-molecular instantaneous reaction between reactants taking place only at the fringe.
3. The contaminant source (Electron Donor) penetrates entire thickness of the aquifer, i.e., $M = A_t$

#### Solving for $L_{max}$ using Liedl et al. (2011) ####

Iterative methods is required to solve for $L_{max}$ using eq.  {eq}`eqli2011`. This is because eq.  {eq}`eqli2011` is implicit with respect to $L_{max}$. [Newtwon-Raphson](https://en.wikipedia.org/wiki/Newton%27s_method) iterative scheme is used in **CAST**. The details below very briefly describe the used scheme. 


Newtwon-Raphson iterative methods requires finding the first derivative of eq. {eq}`eqli2011`, and a good starting value to initiate the iterator. 

CAST uses central [Finite Difference](https://en.wikipedia.org/wiki/Finite_difference) scheme to obtain the required defferential. 




For initial value $L_{max}$ estimated from [Liedl et al. (2005)](liedl2005.md) model is used.


```python
x = 1
y = x*2+x**2
print(x)

```

for ii in range(100):
  print("This is a test.")

import sympy as sym
x, y = sym.symbols('x y')
z = sym.Function('z')
z = sym.sqrt(x**2+y**2)
glue("example_eq", z, display=True)

To glue a math equation try
```{glue:math} example_eq
:label: glue-eq-example
```




```{admonition} Click the button to reveal!
:class: dropdown
Some hidden toggle content!

![](images/an_li2011_f1.png)
```

```{toggle}
Some hidden toggle content!

```{figure} images/an_li2011_f1.png
---
scale: 40%
align: center
name: li2011
---
Liedl et al. (2011)- Conceptual problem

```



**Reference**

(refli2011)=
Liedl, R., Yadav, P.K., Dietrich, P., 2011. Length of 3-D mixing-controlled plumes for a fully penetrating contaminant source with finite width. Water Resour. Res. 47. https://doi.org/10.1029/2010WR009710